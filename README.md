# 편의점

## 기능 목록

### 1. 사용자 입력 처리
- 구매 상품 입력: 구매할 상품명과 수량을 입력받는다.
- 프로모션 상품 추가 구매 입력: 프로모션 적용이 가능한 상품에 대해 고객이 해당 수량보다 적게 가져온 경우, 그 수량만큼 추가 여부를 입력받는다.
- 프로모션 상품 일부 정가 구매 입력: 프로모션 재고가 부족하여 일부 수량을 프로모션 혜택 없이 결제해야 하는 경우, 일부 수량에 대해 정가로 결제할지 여부를 입력받는다.
- 멤버십 할인 여부 입력: 멤버십 할인 적용 여부를 입력받는다. 
- 추가 구매 여부 입력: 추가로 구매할지 여부를 입력받는다.

<br>


### 2. 프로모션 확인 및 적용
- 프로모션 확인: 구매한 상품에 프로모션이 적용되는지 확인한다.
  - 프로모션이 없는 경우: 일반 재고에서 차감 후 `금액 계산`으로 이동한다.
  - 프로모션이 있는 경우: 아래 세부 과정을 진행한다.

- 프로모션 재고 확인:
    - 프로모션 재고가 0인 경우: 일반 재고에서 차감 후 `금액 계산`으로 이동한다.
    - 프로모션 재고가 있는 경우: 행사 기간을 확인하여 처리한다.

- 행사 기간 확인:
  - 행사 기간이 아닐 경우: 일반 재고에서 차감 후 `금액 계산`으로 이동한다.
  - 행사 기간일 경우: 프로모션 조건(해당 개수와 최소 구매 개수)을 정의하고 아래 세부 과정을 진행한다.
> ex) 2+1 행사 상품 -> 해당 개수: 3개, 최소 구매 개수: 2개

- 구매 개수와 프로모션 조건 비교:
  - A. 구매 개수가 프로모션 최소 구매 개수보다 적은 경우:   
  일반 재고에서 차감 후 `금액 계산`으로 이동한다.
  - B. 구매 개수가 최소 구매 개수 이상이지만 프로모션 해당 개수 미만인 경우:   
  부족한 수량을 추가 구매할지 여부를 묻고, 사용자 응답에 따라 처리한다.
    - 추가하지 않을 경우: 일반 재고에서 차감 후 `금액 계산`으로 이동한다.
    - 추가할 경우: 구매 개수를 업데이트한 후 아래 과정을 계속 진행한다.
  - C. 구매 개수가 해당 개수 이상인 경우: 아래 과정을 계속 진행한다.
  
- 프로모션 재고와 구매 수량 비교:
   - 프로모션 재고가 구매 수량보다 적을 경우:   
  프로모션 혜택 없이 결제해야 하는 수량을 정가로 결제할지 여부를 묻고, 사용자 응답에 따라 처리한다.
  - 프로모션 재고가 충분할 경우: 프로모션 적용 후 남은 재고를 관리한다.
  
- 프로모션 혜택 없는 수량 정가 결제 여부 확인:
  - 정가로 결제할 경우: 프로모션 재고를 우선 차감 후 일반 재고에서 차감한다.
  - 정가로 결제하지 않을 경우: 프로모션을 받을 수 없는 수량을 구매 개수에서 제외한다.

<br>

### 3. 금액 계산
- 총 구매 금액 계산: 구매 개수와 상품 가격을 곱해 총 구매 금액을 계산한다. 
- 증정 상품 개수 계산: 프로모션에 따라 증정 받을 수 있는 상품의 개수를 계산한다. 
- 프로모션 할인 금액 계산: 증정 상품의 총 금액을 프로모션 할인 금액으로 계산한다. 
- 정가 결제 금액 계산: 프로모션 혜택이 적용되지 않은 수량의 정가 결제 금액을 계산한다.

<br>

### 4. 멤버십 할인 적용
- 멤버십 할인 적용 여부 확인: 멤버십 할인 적용 여부를 묻고, 사용자 응답에 따라 처리한다.
   - 미적용 시: 총 구매 금액에서 프로모션 할인 금액을 차감한 금액을 최종 결제 금액으로 설정한다.
   - 적용 시: 정가 결제 금액의 30%를 할인 금액으로 계산하며, 할인 금액이 8,000원을 초과할 경우 최대 할인 한도 8,000원을 적용한다.
- 최종 결제 금액 계산: 총 구매 금액에서 프로모션 할인 금액과 멤버십 할인 금액을 차감해 최종 결제 금액을 산출한다.

<br>

### 5. 추가 구매 및 영수증 출력
- 추가 구매 여부 확인: 추가 구매 여부를 묻고, 사용자 응답에 따라 처리한다. 
  - 추가 구매 시: 재고 업데이트 후 상품 구매 처리를 다시 진행한다. 
  - 추가 구매하지 않을 경우: 영수증을 출력하고 구매를 종료한다.
- 영수증 출력:   
  - 구매한 상품명, 수량, 개별 금액을 포함하여 출력한다.   
  - 증정 받은 상품 내역을 포함하여 출력한다.   
  - 총 구매 금액, 행사 할인 금액, 멤버십 할인 금액, 최종 결제 금액을 정리하여 출력한다.



## 예외 상황

### 구매 상품 입력
  - 한 개의 상품과 수량이 `[상품명-수량]` 형태로 입력되지 않은 경우
  > 에러 메시지: [ERROR] 올바르지 않은 형식으로 입력했습니다. 다시 입력해 주세요.

  - 여러 개의 상품과 수량이 `[상품명-수량],  [상품명-수량]` 형태로 입력되지 않은 경우
  > [ERROR] 올바르지 않은 형식으로 입력했습니다. 다시 입력해 주세요.

  - 상품명에 편의점이 보유하고 있는 상품명이 입력되지 않은 경우
  > 에러 메시지: [ERROR] 존재하지 않는 상품입니다. 다시 입력해 주세요.

  - 구매 수량이 재고 수량을 초과한 경우
  > 에러 메시지: [ERROR] 재고 수량을 초과하여 구매할 수 없습니다. 다시 입력해 주세요.

  - 상품명 혹은 수량이 입력되지 않은 경우
  - 구매 수량이 0개 이하인 경우
  - 수량이 숫자로 입력되지 않은 경우
  - 빈 입력인 경우
  

### 프로모션 상품 추가 구매 입력 , 프로모션 상품 일부 정가 구매 입력, 멤버십 할인 여부 입력
  - Y 혹은 N 이외의 입력인 경우
  - 대문자 Y 혹은 대문자 N으로 입력되지 않은 경우

> 에러 메시지 지정되지 않은 예외 상황 모두의 에러 메시지: [ERROR] 잘못된 입력입니다. 다시 입력해 주세요.
